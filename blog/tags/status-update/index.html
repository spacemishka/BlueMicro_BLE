<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="BlueMicro nRF52 Keyboard Firmware RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="BlueMicro nRF52 Keyboard Firmware Atom Feed"><title data-react-helmet="true">One post tagged with &quot;Status Update&quot; | BlueMicro nRF52 Keyboard Firmware</title><meta data-react-helmet="true" property="og:title" content="One post tagged with &quot;Status Update&quot; | BlueMicro nRF52 Keyboard Firmware"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="http://bluemicro.jpconstantineau.com//blog/tags/status-update"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_tag" content="blog_tags_posts"><link data-react-helmet="true" rel="icon" href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAADzVwEA01UhAO6OXwDzUgcA+JZ6APjUxAD4n4IA81ECAOjo6AD35dcA81cCAPRXGwD4oX0A+c+6APNpMwDLn40A/fHnAPX19QD27+0A+unlANTBugD88+oA81MnAPJJAQD++PUA+dPAAP3p3QDzSQEA/e/lAPNLDADHk34A8kAKAL2vrAD96+AA+JhuAP7x6AD5qoYA81IBAP328wDzUhoA+a2GAPNVAQDyWAEA81gBAPJJAgD//v4A9GQqAPz08QD839EA8k8CAPWVZwDtWhUA7l4SAO1RBQD97uEAx2g6APenfwD+7uEA/efcAPJVAgD97eQA70gOAP7t5AD4zrcA/ePXAPiWbQD96d8A8kQJAOp1PgDXnooA9G0zAPnw7QD08vAA+rmgALd8ZwD4zrgA9GIpAPJKAQD5qIYA7V0fAORnNQDzUwEA2djYAPNWAQD87eYA81kBAPjOuQD+8OYA9fT0APBNAgDxNgkA/ezhAPVuMgD5sY8A4WcuAPmwkgD4lG0A81kCAMaUgADHlIAA////APJFCQDwUAMA8WMYAO/UywDtTwYA9X1LAPmxkADySyIAyJJ+ALWqpwDyVCoA0F0rAM1vQwDBmokA/uvdAOmFXwDxTgEA+KqDAPvj2wDzTgEAxV00APRlLAD25d4Awb28APF6RAD97OMA81QBAPFFAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZGRkZGRkEQgIEWRkZGRkZGRkZGRIRXFwN0p8ZGRkZGRkZGQSUDsdKBs7AW5kZGRkZGRkdCoKQyMkGyt5UmRkZGRkR2kDB2VXPE4sNSBkZGRkZAUXa11aNhYVOHVyZGRkZGQNfwtABiFBW0YpYmRkZGRkS1MpJzAtfnolVR5kZGRkZD8ACk0EZEmACmFtZGRkZGRWU01gQhg6XywrY2RkZGRkGXgiHG9zbBB2MQ9kZGRkZFRZalwfOQwaDmYUZGRkZGRkfSkpZRA+TFFeWGRkZGRkZHdnAD0JLiU0aGRkZGRkZGRkZDJPRDMCe2RkZGRkZGRkZGRkJhMvZGRkZGRkZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA="><link data-react-helmet="true" rel="canonical" href="http://bluemicro.jpconstantineau.com//blog/tags/status-update"><link data-react-helmet="true" rel="alternate" href="http://bluemicro.jpconstantineau.com//blog/tags/status-update" hreflang="en"><link data-react-helmet="true" rel="alternate" href="http://bluemicro.jpconstantineau.com//blog/tags/status-update" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.00613c63.css">
<link rel="preload" href="/assets/js/runtime~main.c2b59094.js" as="script">
<link rel="preload" href="/assets/js/main.b5ea2683.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="BlueMicro Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="BlueMicro Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">BlueMicro nRF52 Keyboard Firmware</b></a><a class="navbar__item navbar__link" href="/docs/">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="http://nrf52.jpconstantineau.com/docs/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>BlueMicro Hardware<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/jpconstantineau/Community_nRF52_Arduino/wiki" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>Community nRF52 Arduino Support<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><a href="https://github.com/jpconstantineau/BlueMicro_BLE" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-tags-post-list-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/State of BlueMicro 2022">State of BlueMicro 2022</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><header class="margin-bottom--xl"><h1>One post tagged with &quot;Status Update&quot;</h1><a href="/blog/tags">View All Tags</a></header><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_d4p0" itemprop="headline"><a itemprop="url" href="/blog/State of BlueMicro 2022">State of BlueMicro 2022</a></h2><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2022-01-10T00:00:00.000Z" itemprop="datePublished">January 10, 2022</time> Â· <!-- -->17 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><a href="https://github.com/jpconstantineau" target="_blank" rel="noopener noreferrer" class="avatar__photo-link avatar__photo"><img class="image_9q7L" src="https://avatars3.githubusercontent.com/u/1149816?s=460&amp;u=521fbf5035ea442b1d07281c0c7573ca3596cf3f&amp;v=4" alt="Pierre Constantineau"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/jpconstantineau" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Pierre Constantineau</span></a></div><small class="avatar__subtitle" itemprop="description">Wireless electronics enthousiast in Canada</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_y2LR" id="a-bluemicro-review-of-2021">A BlueMicro Review of 2021<a class="hash-link" href="#a-bluemicro-review-of-2021" title="Direct link to heading">â€‹</a></h2><p>2021 was an eventful year in the word of wireless mechanical keyboards and BlueMicro. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="wireless-hardware">Wireless Hardware<a class="hash-link" href="#wireless-hardware" title="Direct link to heading">â€‹</a></h3><p>Although BlueMicro was the precursor to many breakout boards now used as controllers for keyboard builds, the <a href="https://nicekeyboards.com/nice-nano/" target="_blank" rel="noopener noreferrer">nice!nano</a> is now the most popular in the mechanical keyboard community, followed by the nRF52840 feather express for handwired builds and the <a href="https://github.com/joric/nrfmicro" target="_blank" rel="noopener noreferrer">nrfmicro</a> for more adventurous builders. The <a href="https://www.tindie.com/search/?q=bluemicro840" target="_blank" rel="noopener noreferrer">BlueMicro840</a> is still an option but as my time is limited and they are manually assembled, their supply was limited, even before the chip shortage hit the needed modules (more to come on that...).  For more GPIOs, there is the BlueMacro840 which makes available more GPIOs.</p><p>The first all-in-one keyboards I designed in 2021 was the <a href="https://www.tindie.com/products/jpconstantineau/2x4-ble-macropad-for-mechanical-switches/" target="_blank" rel="noopener noreferrer">BlueHand</a>. A simple 8-keys hand-sized wireless mechanical keyboard that&#x27;s been designed for <a href="https://artsey.io/" target="_blank" rel="noopener noreferrer">Artsey.io</a>; a one-handed keyboard typing system that uses chording for registering keypresses.  </p><p>The chip shortage has affected the supply of processors for many projects. The nrf52840 modules used for the Bluemicro840, BlueHand and nrfmicro became scarce and the few modules that could be found went for 6x their original prices; making the modules even more expensive than a Nice!Nano. </p><p>This has prompted me to create the <a href="https://www.tindie.com/products/jpconstantineau/ebyte-e73-2g4m08s1e-breakout-bluemicro833-pcba/" target="_blank" rel="noopener noreferrer">BlueMicro833</a>, based on the now available nrf52833 modules which are almost identical to the 840 modules at a similar price as the original nRF52840 modules a year ago.  The most important differences are RAM and Flash sizes.  Unfortunately, firmware support is lacking.  A BlueMicro833 was sent to the ZMK team for testing and it tested fine with ZMK. </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="is-new-hardware-even-possible-with-the-chip-shortage">Is new hardware even possible with the chip shortage?<a class="hash-link" href="#is-new-hardware-even-possible-with-the-chip-shortage" title="Direct link to heading">â€‹</a></h3><p>In early 2021, Raspberry Pi introduced the RP2040.  The RP2040 is a dual core ARM Cortex M0+ chip with interesting peripherals and is very cheap.  It&#x27;s only wired - no BLE with this chip.  Because the RP2040 is the first microcontroller from Raspberry Pi, it had no pre-existing users (for example, car manufacturers), it saw really good availability, even <a href="https://jlcpcb.com/parts/componentSearch?isSearch=true&amp;searchTxt=rp2040" target="_blank" rel="noopener noreferrer">JLCPCB</a> has it for PCBA. Circuitpython was available relatively quickly. A few <a href="https://www.youtube.com/watch?v=X00Cm5LMNQk" target="_blank" rel="noopener noreferrer">videos are on Youtube</a> on how to design a rp2040 board made the task quite simple.  Raspberry PI even provided a <a href="https://datasheets.raspberrypi.com/rp2040/hardware-design-with-rp2040.pdf" target="_blank" rel="noopener noreferrer">reference design</a>.  As such, I introduced <a href="https://circuitpython.org/downloads?q=pykey" target="_blank" rel="noopener noreferrer">PyKey</a>, a suite of mechanical keyboards with a RP2040 as the processor, starting with <a href="https://circuitpython.org/board/jpconstantineau_pykey60/" target="_blank" rel="noopener noreferrer">PyKey60</a>, a 60% keyboard based on the GH60 form factor (More sizes are now available: Numpad, TKL, 44-keys Ergo).</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="wireless-firmware">Wireless Firmware<a class="hash-link" href="#wireless-firmware" title="Direct link to heading">â€‹</a></h3><p>QMK has retained the dominant firmware for mechanical keyboards but ZMK became the dominant choice for newcomers to wireless DIY mechanical keyboards. Based on the Zephyr project, it has a good follower base. Just like QMK, it focuses on a readily available firmware and not on basic troubleshooting tools that can help the DIY builder troubleshooting their hardware troubles.  Additionnaly, as ZMK uses the Zephyr BLE stack and not the Nordic SoftDevice, some users have faced issues pairing with some devices (Apple mostly). Some of these users have gone to BlueMicro_BLE and their pairing troubles were resolved. </p><p>Bluemicro_BLE being based on the Arduino nRF52 board support package from Adafruit, is much more friendly in case the user needs to create their own code to troubleshoot their hardware. </p><p>Since Adafruit will only include boards that they <a href="https://github.com/adafruit/Adafruit_nRF52_Arduino/pull/596#issuecomment-714900359" target="_blank" rel="noopener noreferrer">sell</a> within their nRF52 Arduino Board support package, I created a fork of the BSP (and disconnected it) and created the <a href="https://github.com/jpconstantineau/Community_nRF52_Arduino" target="_blank" rel="noopener noreferrer">Community Add-On nRF52 Board Support Package</a> to which changes were made; most importantly, the addition of many nRF52 boards and keyboards available to the community.  My decision to split the code base from the source repository was mainly based on the desire remove the problematic code causing <a href="https://github.com/adafruit/Adafruit_nRF52_Arduino/issues/600" target="_blank" rel="noopener noreferrer">high current consumption</a>, but also to keep a fork for me to be able to contribute to the main repository while having a separate repo for the Community boards.  Unfortunately, this decision came to bite me when many positive changes were pushed to the Adafruit nRF52 Arduino Board Support Package.</p><p>In order to make more options available for users, support for CircuitPython was added for the BlueMicro840. Circuitpython adds a new framework by which one can code their keyboards and even troubleshoot their hardware. You can go to the <a href="http://pykey.jpconstantineau.com/docs/testing_hardware/keymatrix" target="_blank" rel="noopener noreferrer">PyKey</a> project to see lots of keyboard troubleshooting tips with CircuitPython.</p><p>CircuitPython also makes <a href="https://github.com/KMKfw/kmk_firmware" target="_blank" rel="noopener noreferrer">KMK</a> an option for BlueMicro840 users. I even designed an ultra-portable wireless keyboard that uses 44 Kailh Thin keys that saw KMK as the first firmware to run on it.  I year ago, I never coded any Python. Today, I can count a few of my keyboards within the <a href="https://github.com/KMKfw/kmk_firmware/tree/master/boards/jpconstantineau" target="_blank" rel="noopener noreferrer">KMK repo</a>; all Python code I wrote...</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="firmware-for-nrf52833">Firmware for nRF52833<a class="hash-link" href="#firmware-for-nrf52833" title="Direct link to heading">â€‹</a></h3><p>Unfortunately, support for the Nordic nRF52833 in the Arduino IDE is non-existent. There were a <a href="https://github.com/adafruit/Adafruit_nRF52_Arduino/pulls?q=is%3Apr++nrf52833+" target="_blank" rel="noopener noreferrer">few PRs</a> but none were included in the Adafruit nRF52 Arduino Board Support Package. An issue was raised to ask if the nRF52833 Dev Kit from Nordic would be merged in if a PR would be made (even if on a not-supported basis). <a href="https://github.com/adafruit/Adafruit_nRF52_Arduino/issues/696" target="_blank" rel="noopener noreferrer">No clear response yet</a>.   Without Arduino support for ths chip, BlueMicro_BLE firmware won&#x27;t be able to run on it.  In the meantime, try CircuitPython,KMK or ZMK!  </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="bluemicro_ble">BlueMicro_BLE<a class="hash-link" href="#bluemicro_ble" title="Direct link to heading">â€‹</a></h3><p>2021 started great for BlueMicro_BLE with the addition of a few great features:</p><ul><li>USB and BLE switching - Wireless and Wired on the same keyboard - switched automatically!</li><li>Mutiple BLE Profiles - making it possible to choose which computer to connect it to</li><li>Combos/chording: a new keycode-based chording engine that replaces keycodes when two or more keycodes are detected. (press multiple keys, send something else...). Unlike other firmwares, the engine is not key based but keycode-based.</li><li>BlueMicro_Builder: Inspired by the simple build process of ZMK, a new <a href="https://github.com/jpconstantineau/BlueMicro_Builder" target="_blank" rel="noopener noreferrer">BlueMicro_Builder</a> repository template has made available the option for nRF52840 users to have their firmware built by GitHub Actions. Check out the <a href="https://www.youtube.com/watch?v=hKw3TPNu-BQ" target="_blank" rel="noopener noreferrer">video</a> to see how it works!</li></ul><p>With new features, new bugs and issues always come to haunt us, along with more feature requests...  2022 will look at resolving some of the more fundamental problems, bringing 1.3.0 BSP support all while enabling easier future improvements. </p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="whats-coming-in-2022-for-bluemicro">What&#x27;s coming in 2022 for BlueMicro?<a class="hash-link" href="#whats-coming-in-2022-for-bluemicro" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="update-to-latest-adafruit-nrf52-arduino-bsp">Update to Latest Adafruit nRF52 Arduino BSP.<a class="hash-link" href="#update-to-latest-adafruit-nrf52-arduino-bsp" title="Direct link to heading">â€‹</a></h3><p>With all the major changes to TinyUSB completed and rolled into the adafruit nRF52 board support package, as well as the support for multiple Bluetooth profiles from the Adafruit BSP itself, there are no core changes in the Community Board Support pachages that are needed, except for the additional boards.  As such, a staged approach will be taken to update both the <a href="https://github.com/jpconstantineau/BlueMicro_BLE" target="_blank" rel="noopener noreferrer">BlueMicro_BLE</a> firmware and the <a href="https://github.com/jpconstantineau/Community_nRF52_Arduino" target="_blank" rel="noopener noreferrer">Community Add-On nRF52 Board Support Package</a> to the latest BSP.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="unifying-the-interface-for-usb-and-ble-hid">Unifying the interface for USB and BLE HID<a class="hash-link" href="#unifying-the-interface-for-usb-and-ble-hid" title="Direct link to heading">â€‹</a></h3><p>In 2021, I started the effort to unify the BLE and USB calls into a single library, starting from thr ground up using the HID_Composite examples.  After countless hours of unsuccessful and hair-pulling code streams, I finally have something working.</p><p>I am planning to make a common HID library that handles both BLE on the nRF52 chips and USB on boards with TinyUSB support. This would be publised as an Arduino Library.  By migrating to this library, this means that Bluemicro_BLE will be able to support the nrf52 chips, the RP2040 and the SAMD21 and SAMD51 chips; at least from a single keyboard point of view. Split keyboards would be next.  The prototype code already runs on multiple Adafruit Feathers (nrf52832, nrf52840, RP2040, SAMD21, SAMD51).</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="making-mousekeys-work-and-make-sense">Making Mousekeys work (and make sense)<a class="hash-link" href="#making-mousekeys-work-and-make-sense" title="Direct link to heading">â€‹</a></h3><p>Since the unified library described above is based on the HID_Composite examples, the library would enable parallel keyboard/mouse/consumer keyscodes to be sent (as opposed to only one of the 3).  This would enable refactoring the code to simplify how the different HID messages are handled.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="what-else">What else?<a class="hash-link" href="#what-else" title="Direct link to heading">â€‹</a></h2><p>What are you looking for as improvements to your keyboard firmware and hardware?</p><p>Here are some of the ideas I have received:</p><ul><li>Enable Pointing devices to be easily integrated within BlueMicro_BLE.  I have had various requests for enabling mouse movements as part of the keyboard functions.  <ul><li><a href="https://datasheet.lcsc.com/lcsc/2110151630_XKB-Connectivity-TM-2027_C318948.pdf" target="_blank" rel="noopener noreferrer">Digital Joystick/5 way switches</a></li><li><a href="https://www.tindie.com/products/robotart/joystick-game-controller-for-arduino/" target="_blank" rel="noopener noreferrer">Analog Joystick</a></li><li><a href="https://shop.pimoroni.com/products/trackball-breakout" target="_blank" rel="noopener noreferrer">Pimoroni Trackball Breakout</a></li><li><a href="https://www.tindie.com/products/jkicklighter/pmw3360-motion-sensor/" target="_blank" rel="noopener noreferrer">PMW3360 Motion Sensor</a>  </li><li><a href="https://www.cirque.com/glidepoint-circle-trackpads" target="_blank" rel="noopener noreferrer">Cirque Trackpads</a></li></ul></li><li>RGB Effects.</li><li>Better handling of USB on secondary side of split keyboards</li><li>Sharing of Toggles and One-shots between sides.</li><li>Improvements to key state logic to handle Tap/Double-Tap/Hold on the same key. </li><li>Enable &quot;delays&quot; in macros.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="circuitpython-2022">CircuitPython 2022<a class="hash-link" href="#circuitpython-2022" title="Direct link to heading">â€‹</a></h2><p>Since BlueMicro has a focus on keyboards and other HID/Input devices, this will obviously have a keyboard focus; either to help generic firmware, KMK or enable users develop more complex keyboards from a common set of building blocks.  As I am not a Python developer, I don&#x27;t expect to be able to make significant contributions to libraries but I can contribute to new boards reviews, minor core additions and commenting on use of specific libraries I might use.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="keypad-extensions">Keypad extensions<a class="hash-link" href="#keypad-extensions" title="Direct link to heading">â€‹</a></h3><p>The keypad core module defines a simple interface by which keypress/keyrelease events are provided to the user for acting upon.  Using this common interface for detecting key presses is currently a Work in Progress in <a href="https://github.com/KMKfw/kmk_firmware/issues/237" target="_blank" rel="noopener noreferrer">KMK</a>. </p><p>Expanding the use of the keypad API to non-board GPIOs would be a natural extension.</p><p>To enable flexibility in how people design their keyboards, the following GPIO expanders should be included as part of an add-on keypad library (or family of libraries).</p><ul><li><a href="https://www.adafruit.com/product/5346" target="_blank" rel="noopener noreferrer">MCP23017 GPIO Expander</a></li><li><a href="https://www.nxp.com/products/interfaces/ic-spi-serial-interface-devices/ic-general-purpose-i-o/40-bit-ic-bus-i-o-port-with-reset-oe-and-int:PCA9505_06" target="_blank" rel="noopener noreferrer">PCA9505 GPIO Expander</a></li><li>PCF8574 GPIO Expander</li><li><a href="https://www.adafruit.com/product/3657" target="_blank" rel="noopener noreferrer">Adafruit ATSAMD09 Breakout with seesaw</a></li><li><a href="https://www.adafruit.com/product/5233" target="_blank" rel="noopener noreferrer">Adafruit ATtiny817 Breakout with seesaw</a></li></ul><p>The add-on library would make I2C devices available with the same API as the core keypad module.  This way, people could use the same code regardless where their keys and keypads are connected to.</p><p>A great example of a split keyboard that uses multiple GPIO expanders is Zack Freedman&#x27;s MiRage keyboard. Check out his <a href="https://youtu.be/Fg0V5M0llaE" target="_blank" rel="noopener noreferrer">video</a> and his <a href="https://github.com/ZackFreedman/MiRage" target="_blank" rel="noopener noreferrer">repo</a>.  </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hide-your-ghosts">Hide your <a href="https://www.youtube.com/watch?v=CFSjnV7zUYM" target="_blank" rel="noopener noreferrer">ghosts</a><a class="hash-link" href="#hide-your-ghosts" title="Direct link to heading">â€‹</a></h3><p>Another possible extension but to the core keypad module would be to enable key matrices that do not have anti-ghosting diodes.  One of the BlueMicro_BLE contributors has  an <a href="https://bitbucket.org/akudaikon/bluemicro-model-m/src/3ac5081226541f5c06abdcb7b2676a80f0b867bb/firmware/firmware_main.cpp?at=master#firmware_main.cpp-248" target="_blank" rel="noopener noreferrer">example</a> where ghost key detection and filtering is done so that ghost keys are not included as part of the key state transitions.  Adding diodes is not always possible as this code is used as part of a Model M keyboard Wireless retrofit. Other keyboards might not have the room for diodes - check out this <a href="https://youtu.be/iWWTJKWFNok" target="_blank" rel="noopener noreferrer">Tiny Pico Keyboard</a> for an idea how small one can go.  I have my own wireless one that&#x27;s based on the BlueMicro840 but has the footprint of a Raspberry Pi Zero.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="make-your-own-seesaw">Make your own SeeSaw<a class="hash-link" href="#make-your-own-seesaw" title="Direct link to heading">â€‹</a></h3><p>Adafruit has led an interesting I2C revolution with the introduction of multiple SeeSaw input devices:</p><ul><li><a href="https://www.adafruit.com/product/4980" target="_blank" rel="noopener noreferrer">NeoKey 1x4 QT I2C</a></li><li><a href="https://www.adafruit.com/product/4991" target="_blank" rel="noopener noreferrer">Adafruit I2C QT Rotary Encoder</a></li><li><a href="https://www.adafruit.com/product/5295" target="_blank" rel="noopener noreferrer">Adafruit NeoSlider I2C QT Slide</a></li><li><a href="https://www.adafruit.com/product/3632" target="_blank" rel="noopener noreferrer">Adafruit Joy FeatherWing for all Feathers</a></li><li><a href="https://www.adafruit.com/product/802" target="_blank" rel="noopener noreferrer">Adafruit 1.8&quot; Color TFT Shield w/microSD and Joystick</a></li><li><a href="https://www.adafruit.com/product/3321" target="_blank" rel="noopener noreferrer">Adafruit Mini Color TFT with Joystick FeatherWing</a></li></ul><p>Split keyboards could be designed with the secondary side being a custom SeeSaw device, while the primary side would be standard CircuitPython or Arduino code.</p><p>There is an <a href="https://github.com/adafruit/Adafruit_seesawPeripheral" target="_blank" rel="noopener noreferrer">Arduino Library</a> for creating your own seesawPeripheral, however, it seems that it&#x27;s only supported by the megaTinyCore (AVR) chips (although the library properties seems to indicate otherwise).  It would be very useful to be able to create your own SeeSaw device using CircuitPython.  Take a KB2040, a Raspberry Pi Pico, a Feather M4 or a small SAMD21 board and re-purpose it as a SeeSaw co-processor for handling remote input/output devices.  If CircuitPython can&#x27;t be used due to size limitations, an Arduino library for use with the SAMD21 would be useful.  I believe porting the I2C peripheral module to other chips would be the starting  point.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="split-keyboards-and-the-kb2040-and-pro-micro-rp2040">Split keyboards and the KB2040 (and Pro Micro RP2040):<a class="hash-link" href="#split-keyboards-and-the-kb2040-and-pro-micro-rp2040" title="Direct link to heading">â€‹</a></h3><p>To understand the potential issues with the RP2040 on a board with the form factor of the Pro Micro, we need to see a brief history of split keyboards and how communications was handled between the halves. </p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="a-recent-history-of-split-keyboards">A recent history of split keyboards<a class="hash-link" href="#a-recent-history-of-split-keyboards" title="Direct link to heading">â€‹</a></h4><p>The table below presents a brief list of split keyboards, starting with the Original Ergodox from 2013.  The Let&#x27;s Split V2 is the board that truely kicked-off the DIY Split keyboard explosion of options.  It&#x27;s inspired from the Planck but divided into two halves.</p><p>A number of commercial keyboards have not been included due to their closed source PCBs. Nevertheless, this list is very small. Have a look <a href="https://golem.hu/boards/" target="_blank" rel="noopener noreferrer">here</a> is you want to see a large database of split boards...</p><table><thead><tr><th>Board</th><th>Date</th><th>PCB Repo</th><th>Build Guide</th><th>Serial Pin</th><th>I2C</th></tr></thead><tbody><tr><td>ErgoDox Original</td><td>July 2013</td><td><a href="https://github.com/bishboria/ErgoDox" target="_blank" rel="noopener noreferrer">PCB</a></td><td>-</td><td>n/a</td><td></td></tr><tr><td>ErgoDox IO</td><td>Dec 2016</td><td><a href="https://github.com/Ergodox-io/ErgoDox/blob/master/README.md" target="_blank" rel="noopener noreferrer">PCB</a></td><td>-</td><td>n/a</td><td>MCP23018</td></tr><tr><td>Let&#x27;s Split V2</td><td>April 2017</td><td><a href="https://github.com/climbalima/let-s-Split-v2" target="_blank" rel="noopener noreferrer">PCB Repo</a></td><td><a href="https://github.com/nicinabox/lets-split-guide" target="_blank" rel="noopener noreferrer">Build Guide</a></td><td>D0</td><td>D1/D0</td></tr><tr><td>Minidox</td><td>August 2017</td><td><a href="https://github.com/That-Canadian/MiniDox_PCB" target="_blank" rel="noopener noreferrer">PCB</a></td><td>Guide</td><td>D0</td><td>n/a</td></tr><tr><td>Helix</td><td>February 2018</td><td><a href="https://github.com/MakotoKurauchi/helix" target="_blank" rel="noopener noreferrer">PCB</a></td><td><a href="https://github.com/MakotoKurauchi/helix/blob/master/Doc/buildguide_en.md" target="_blank" rel="noopener noreferrer">Guide</a></td><td>D0 (V1), D2 (V2)</td><td>Oled</td></tr><tr><td>ErgoTravel</td><td>June 2018</td><td><a href="https://github.com/jpconstantineau/ErgoTravel" target="_blank" rel="noopener noreferrer">PCB</a></td><td><a href="https://github.com/jpconstantineau/ErgoTravel/blob/master/BuildInstructions.md" target="_blank" rel="noopener noreferrer">Guide</a></td><td>D0</td><td>D1/D0</td></tr><tr><td>Lily58</td><td>October 2018</td><td><a href="https://github.com/kata0510/Lily58" target="_blank" rel="noopener noreferrer">PCB</a></td><td></td><td>D2</td><td>Oled</td></tr><tr><td>Sofle</td><td>Sept 2019</td><td><a href="https://github.com/josefadamcik/SofleKeyboard" target="_blank" rel="noopener noreferrer">PCB</a></td><td>Guide</td><td>D2</td><td>Oled</td></tr><tr><td>Corne</td><td>October 2019</td><td><a href="https://github.com/foostan/crkbd" target="_blank" rel="noopener noreferrer">PCB</a></td><td>Guide</td><td>D2</td><td>Oled</td></tr></tbody></table><p>On the Pro Micro, D0/D1 are SCL/SDA and D2/D3 are RX/TX.</p><p>As you can see from the table, the design of the Let&#x27;s Split opted for making the selection of I2C an option by using the SCL line as a serial line between the two boards.  This freed a data line for users to add RGB data between the two halves.  Most builds that used the Let&#x27;s Split as a template used D0 with software serial.  Some kept the option for I2C, others dropped it.</p><p>However, with the addition of I2C OLED screens on the Helix, serial communications between the two halves was relocated to be on D2 (See differences between V1 and V2).  Since D2 is RX, on one side hardware UART can be used but software UART has to be used on the other side.  This allows for 1-way communications.  2-way comms would need to use software serial with some software handshaking to handle direction changes (and perhaps a resistor to limit current in case of TX on both sides at the same time); 2-way serial is probably not generally implemented on a single line due to the additional complexity.  </p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="the-problem-with-the-rp2040-and-hardware-uart">The problem with the RP2040 and hardware UART<a class="hash-link" href="#the-problem-with-the-rp2040-and-hardware-uart" title="Direct link to heading">â€‹</a></h4><p>Unlike the nRF52 where any GPIO can be used for I2C and UART, the RP2040 has some restrictions on what functions are available for each GPIO.  If one wants to use non-standard (i.e. not in the table of page 13-14 of the <a href="https://datasheets.raspberrypi.com/rp2040/rp2040-datasheet.pdf" target="_blank" rel="noopener noreferrer">datasheet</a>), you have to use the PIO to create your own UART RX or TX (Datasheet Page 373) peripherals.  Since most pro-micro keyboards that used  I2C, relied on hardware for I2C.  However, to keep build flexibility and cost of PCB designs low, the same I2C pins were re-used but for serial.  Serial communications were slao setup with a single line to leave a line free for &quot;RGB Data&quot;.  Using the same data pin on each side allowed for mirrored builds and for the possibility of setting up both sides identically and automatically detecting which side is primary or secondary by monitoring whether USB is connected; hence detecting the desired data direction on the serial line.  </p><p>This means that serial connection of many (if not most) split keyboards will rely on &quot;non-standard&quot; RX/TX pins definition compared to the default Arduino Pro Micro definitions.</p><p>For existing split keyboards to work, we need software UART (or PIO UART) in CircuitPython.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="i2cperipheral-for-other-chips-rp2040-samd21-nrf52-etc">I2CPeripheral for other chips (RP2040, SAMD21, nRF52, etc)<a class="hash-link" href="#i2cperipheral-for-other-chips-rp2040-samd21-nrf52-etc" title="Direct link to heading">â€‹</a></h3><p>To enable I2C communications between keyboard halves or to build your own seesaw board using CircuitPython, I2CPeripheral on the RP2040 and other chips is needed.  Once available, a seesaw_peripheral library will be possible.  Possibly leveraging the adafruit_register.i2c_struct.Struct function, perhaps in a bi-directional way: define the same registers on both sides of the communication channel and let the I2C &quot;magic&quot; do its thing...   </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="very-deep-sleep-on-the-nrf52">Very Deep Sleep on the nRF52<a class="hash-link" href="#very-deep-sleep-on-the-nrf52" title="Direct link to heading">â€‹</a></h3><p>I have an <a href="http://pykey.jpconstantineau.com/docs/testing_hardware/sleep" target="_blank" rel="noopener noreferrer">article</a> that compares ZMK, BlueMicro_BLE and CircuitPython running and sleep current on the same device.  Unlike the other two, CircuitPython isn&#x27;t a compiled language.  As such, power consumption when running will never be able to reach the level of designed-for-purpose compiled code. Nevertheless, when going in deep sleep, the chip shouldn&#x27;t be running and one would expect a comparable current.  Unfortonately, how deep sleep is implemented in CircuitPython is more of a &quot;nap&quot; than a sleep.  The chip regularly wakes up to check the state of alarm pins, then goes back napping until the next check.</p><p>As such, there is the possibility for an even deeper sleep for the nRF52 chips running CircuitPython.  I don&#x27;t know what it should be called as &quot;deep sleep&quot; is already taken. The article mentionned above highlights how it&#x27;s done and how it behaves (full reboot on wake-up).  This &quot;Very Deep Sleep&quot; needs an external pin to be toggled for the wake-up to occur.  For keyboards, a simple keeypress does the job.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="bluemicro833">BlueMicro833<a class="hash-link" href="#bluemicro833" title="Direct link to heading">â€‹</a></h3><p>  Detailed testing of the Bluemicro 833 with Circuitpython and KMK is needed to see how much useful room is available, both for Ram and Flash space.  Having half the flash and ram as the nRF52840, I suspect that we may run into similar issues as the SAMD21.  The SAMD21 has so little ram that it runs out of it pretty quickly.  The nRF52833 has more, however as this is chip is meant for BLE functions and that the Softdevice consumes a chunk of space already, what&#x27;s left to the user for Python code will be limited.  Testing and Time will tell... </p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="circuitpythonorg-improvements">Circuitpython.org Improvements<a class="hash-link" href="#circuitpythonorg-improvements" title="Direct link to heading">â€‹</a></h3><p>I would like to recommend a few minor improvements to the download page of CircuitPython.org, especially when it gets to filtering by chip family/chip type.  With 269 boards, and going up regularly, filtering will become more important to find a board of choice for your next project.</p><p>The Atmel-Samd Processor Family includes SAMD21 and SAMD51 boards (ARM M0/M4) while the nRF52 Family is non-existant but nRF52840 is present instead of having nRF52833 and nRF52840 as separate chips.</p><p>A filter hierarchy similar to the tree below would enable users to search for boards with a specific processor.</p><ul><li>Atmel-Samd<ul><li>SAMD21</li><li>SAMD51</li></ul></li><li>Broadcom</li><li>Cxd56</li><li>Espressif<ul><li>Esp32c3</li><li>Esp32s2</li><li>Esp32s3</li></ul></li><li>Litex</li><li>Mimxrt10xx</li><li>nRF52<ul><li>nRF52833</li><li>nRF52840</li></ul></li><li>Raspberry Pi<ul><li>RP2040</li></ul></li><li>STM<ul><li>F4</li><li>H7</li><li>F7</li><li>L4</li></ul></li></ul><p>Some people might be interested in filtering by the core type as follows:</p><ul><li>ARM Cortex M0 </li><li>ARM Cortex M4</li><li>RISC-V</li><li>ARM Cortex-A7</li><li>ARM Cortex-A53</li></ul><p>However, as you can already filter by the processor family, I doubt this will provide much value;  only those asking &quot;Does it run on RISC-V?&quot; will get an answer...</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="awesome-circuitpython-improvements">Awesome CircuitPython Improvements<a class="hash-link" href="#awesome-circuitpython-improvements" title="Direct link to heading">â€‹</a></h3><p>It would be neat to add a section/page/subpage to Awesome CircuitPython called <em>Popular Projects Enabled by CircuitPython</em></p><p>This could include:</p><ul><li><a href="https://github.com/KMKfw/kmk_firmware" target="_blank" rel="noopener noreferrer">KMK Keyboard Firmware</a></li><li><a href="https://github.com/dbisu/pico-ducky" target="_blank" rel="noopener noreferrer">Pico Ducky</a></li></ul></div><footer class="row docusaurus-mt-lg"><div class="col col--9"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/blue-micro">BlueMicro</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/status-update">Status Update</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/circuit-python">CircuitPython</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/blog/tags/circuit-python-2022">CircuitPython2022</a></li></ul></div><div class="col text--right col--3"><a aria-label="Read more about State of BlueMicro 2022" href="/blog/State of BlueMicro 2022"><b>Read More</b></a></div></footer></article></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/ecnCR9P" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.youtube.com/channel/UCFpGp4hHe03nvF9c8_gF_jA" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/jpconstantineau/BlueMicro_BLE" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 Pierre Constantineau. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.c2b59094.js"></script>
<script src="/assets/js/main.b5ea2683.js"></script>
</body>
</html>